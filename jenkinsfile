pipeline {
    agent any
    environment{

        def appversion = ''

    }
    stages {
        
        stage("Deploy"){

            steps{
                sh """

                echo "this the first stage dependencies"
               
                """

            }
        }
        stage("dependencies"){

            steps{
                sh """
                echo "this the second stage dependencies"
                npm install
                ls -ltr

                """
            }
        }
        stage("artifactory"){
            steps{
                script{
                                
                    def packageJSON = readJSON file: 'package.json'
                    appversion = packageJSON.version
                    echo "packagrJsonversion: $appversion"
                    
                }
            }
        }
        stage("artifactory Print"){

            steps{
                sh """
                
                 zip -q "backend-$appversion".zip  */ -x jenkinsfile  package.json *.zip

                """    

                  
            }
            
        }

    }
}